# Мониторинг температуры MCU и хоста на Qidi Q1 Pro

## Описание

![Fluidd](docs/images/fluid-temp.jpg)
Данная модификация позволяет отслеживать температуры всех важных компонентов вашего принтера Qidi Q1 Pro в интерфейсе Fluidd/Mainsail. Это поможет контролировать состояние оборудования и предотвратить перегрев.

## Что мониторится

- **Host CPU (MKSPI)** - температура одноплатного компьютера
- **Mainboard MCU (STM32)** - температура основной платы управления
- **Toolhead MCU (RP2040)** - температура платы управления экструдером

## Установка

### Шаг 1: Резервное копирование

Перед внесением изменений создайте резервную копию вашего файла `printer.cfg`:

```bash
cp /home/mks/klipper_config/printer.cfg /home/mks/klipper_config/printer.cfg.backup
```

### Шаг 2: Редактирование конфигурации

Откройте файл `printer.cfg` через веб-интерфейс Fluidd/Mainsail или через SSH:

```bash
nano /home/mks/klipper_config/printer.cfg
```

### Шаг 3: Добавление секций мониторинга

Добавьте следующие блоки в ваш файл `printer.cfg`:

```ini
# Температура MKSPI (Host CPU)
[temperature_sensor Host]
sensor_type: temperature_host
min_temp: 0
max_temp: 90

# Температура MCU STM32 (Основная плата)
[temperature_sensor Mainboard_MCU]
sensor_type: temperature_mcu
sensor_mcu: U_1
min_temp: 0
max_temp: 90

# Температура MCU RP2040 (Плата экструдера)
[temperature_sensor Toolhead_MCU]
sensor_type: temperature_mcu
min_temp: 0
max_temp: 90
```

### Шаг 4: Перезапуск Klipper

После сохранения файла перезапустите Klipper:

- В веб-интерфейсе нажмите кнопку **"RESTART"**
- Или через SSH: `sudo systemctl restart klipper`

## Результат

После успешной настройки в интерфейсе Fluidd/Mainsail появятся три новых датчика температуры:

- **Host CPU** - показывает температуру одноплатного компьютера
- **Mainboard MCU** - показывает температуру основной платы STM32
- **Toolhead MCU** - показывает температуру платы экструдера RP2040

## Параметры конфигурации

### Описание параметров:

- `sensor_type: temperature_host` - тип датчика для мониторинга CPU хоста
- `sensor_type: temperature_mcu` - тип датчика для мониторинга температуры MCU
- `sensor_mcu: U_1` - указывает на конкретный MCU (для основной платы)
- `min_temp: 0` - минимальная допустимая температура
- `max_temp: 90` - максимальная допустимая температура

Полное описание конфигурации датчиков температуры в [Klipper](https://www.klipper3d.org/Config_Reference.html#temperature_sensor)

### Настройка температурных лимитов:

Вы можете изменить температурные лимиты в зависимости от ваших потребностей:

```ini
min_temp: 0    # Минимальная температура (°C)
max_temp: 90   # Максимальная температура (°C)
```

При превышении этих лимитов Klipper выдаст предупреждение или остановит печать.

## Неточные показания температуры

Это нормально для MCU датчиков - они показывают приблизительную температуру чипа, а не точную температуру окружающей среды.

**Примечание:** Данная модификация не влияет на работу принтера, она только добавляет мониторинг температуры для лучшего контроля состояния оборудования.
